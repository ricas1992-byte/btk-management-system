# מודול 3: מבנה היררכי - מדריך שימוש

## סקירה כללית

מודול 3 (סביבת למידה) עודכן לתמוך במבנה היררכי של:
**קורס → יחידה → סוג מסמך → קובץ**

---

## שדות Metadata חדשים

כל קובץ במודול 3 מכיל כעת את השדות הבאים:

### 1. Course (קורס)
קוד הקורס, אחד מהאפשרויות הבאות:
- `C01` – מבוא לאנטומיה ומכניקה של נגינה
- `C02` – מבוא למדעי המוח במוזיקה
- `C03` – מבוא למחקר למוזיקאים
- `C04` – נוירופלסטיות ולמידה ממוקדת
- `C05` – יומן אימון: מתודולוגיה איכותנית
- `C06` – ניתוח תנועה וקשב בנגינה
- `C07` – תכנון מחקר אישי (Pre-Project)

### 2. UnitNumber (מספר יחידה)
מזהה היחידה בפורמט: `U01`, `U02`, `U03`, וכו'.

### 3. DocumentType (סוג מסמך)
סוג המסמך, אחד מהאפשרויות הבאות (בסדר היררכי):
1. `Theory` - תיאוריה
2. `Exercise` - תרגול
3. `Summary` - סיכום
4. `Reflection` - רפלקציה

### 4. Language (שפה)
שפת המסמך:
- `he` - עברית
- `en` - English

### 5. שדות נוספים (קיימים)
- `title` - כותרת הפריט
- `type` - סוג קובץ (pdf, text, image, video)
- `content` - תוכן המסמך
- `summary` - תקציר
- `highlights` - מספר הדגשות
- `notes` - מספר הערות
- `userNotes` - מערך של הערות משתמש
- `createdAt` - תאריך יצירה
- `updatedAt` - תאריך עדכון אחרון (נוסף בעריכה)

---

## מבנה אובייקט Metadata מלא

דוגמה לאובייקט פריט מלא:

```json
{
  "id": "1731526400000_abc123def",
  "title": "מבוא לאנטומיה של היד",
  "course": "C01",
  "unitNumber": "U01",
  "documentType": "Theory",
  "language": "he",
  "type": "pdf",
  "content": "תוכן המסמך...",
  "summary": "תקציר קצר של החומר",
  "highlights": 5,
  "notes": 3,
  "userNotes": [
    {
      "text": "הערה ראשונה",
      "createdAt": "2025-11-15 14:30:00"
    }
  ],
  "createdAt": "2025-11-15 14:00:00",
  "updatedAt": "2025-11-15 15:00:00"
}
```

---

## מיקום שמירת Metadata

הנתונים נשמרים ב:
- **קובץ ראשי**: `/data/knowledge.json`
- **מבנה**: מערך `items` שמכיל את כל הפריטים
- **גיבוי**: כל פריט נשמר גם ב-localStorage עם המפתח: `btk_knowledge_${item.id}.json`

---

## תכונות חדשות

### 1. תצוגה היררכית
- התצוגה מאורגנת לפי: **קורס → יחידה → סוג מסמך → קובץ**
- סוגי המסמכים מוצגים בסדר: Theory → Exercise → Summary → Reflection
- כל רמה מוצגת עם צבע ייחודי:
  - קורס: סגול
  - יחידה: כחול
  - סוג מסמך: ירוק

### 2. תצוגה שטוחה
- תצוגת כרטיסיות קלאסית
- כל כרטיס מציג את כל שדות ה-Metadata כתגיות צבעוניות

### 3. סינון וחיפוש
ניתן לסנן פריטים לפי:
- קורס (Course)
- יחידה (UnitNumber)
- סוג מסמך (DocumentType)

### 4. עריכת Metadata
- ניתן לערוך את כל שדות ה-Metadata לאחר יצירת הפריט
- לחיצה על "✏️ עריכה" בעמוד הצפייה פותחת טופס עריכה

---

## קבצים ששונו

### 1. `/script.js` (שורות 560-903)
המחלקה `LearningEnvironmentModule` עודכנה עם:
- **קונסטרקטור מעודכן**: הוספת `viewMode` ו-`currentFilters`
- **`uploadItem()`**: טופס העלאה עם שדות Metadata חדשים
- **`saveItem(itemId)`**: שמירה/עריכה עם Metadata
- **`editItem(itemId)`**: פונקציה חדשה לעריכת פריטים
- **`viewItem(itemId)`**: תצוגה משופרת עם כל שדות ה-Metadata
- **`showKnowledgeList(filters)`**: תצוגה עם סינון
- **`renderHierarchicalView(items)`**: פונקציה חדשה לתצוגה היררכית
- **`renderFlatView(items)`**: פונקציה חדשה לתצוגה שטוחה
- **`toggleViewMode()`**: החלפה בין תצוגות
- **`applyFilter(filterType, value)`**: החלת סינונים

### 2. `/data/knowledge.json`
מבנה הנתונים נשאר זהה, עם הוספת שדות חדשים לכל פריט.

---

## הוספת קורסים/יחידות/סוגי מסמכים חדשים

### הוספת קורס חדש:

1. פתח את הקובץ: `/script.js`
2. מצא את הפונקציה `uploadItem()` (שורה ~635)
3. הוסף אפשרות ל-dropdown של הקורסים:
   ```html
   <option value="C08">C08 – שם הקורס החדש</option>
   ```
4. חזור על התהליך בפונקציה `editItem()` (שורה ~823)

### הוספת סוג מסמך חדש:

1. פתח את הקובץ: `/script.js`
2. מצא את הפונקציה `uploadItem()` (שורה ~635)
3. הוסף אפשרות ל-dropdown של סוגי המסמכים:
   ```html
   <option value="NewType">NewType (תיאור בעברית)</option>
   ```
4. חזור על התהליך בפונקציה `editItem()` (שורה ~823)
5. עדכן את `docTypeOrder` בפונקציה `renderHierarchicalView()` (שורה ~693):
   ```javascript
   const docTypeOrder = ['Theory', 'Exercise', 'Summary', 'Reflection', 'NewType'];
   ```

### הוספת יחידות חדשות:

יחידות נוצרות באופן דינמי על ידי המשתמש (פשוט יש להזין `U08`, `U09`, וכו').
אין צורך בעדכון קוד.

### הוספת שפה חדשה:

1. פתח את הקובץ: `/script.js`
2. מצא את הפונקציה `uploadItem()` (שורה ~635)
3. הוסף אפשרות ל-dropdown של השפות:
   ```html
   <option value="fr">Français (fr)</option>
   ```
4. חזור על התהליך בפונקציה `editItem()` (שורה ~823)

---

## טיפים לשימוש

1. **מעבר בין תצוגות**: השתמש בכפתור "🗂 תצוגה היררכית" / "📋 תצוגה שטוחה"
2. **סינון מהיר**: בחר קורס/יחידה/סוג מהתפריטים הנפתחים בחלק העליון
3. **איפוס סינון**: לחץ על כפתור "📚 הכל"
4. **עריכת Metadata**: צפה בפריט ולחץ על "✏️ עריכה"
5. **ארגון מומלץ**: השתמש בקונבנציות עקביות (למשל: U01, U02 במקום U1, U2)

---

## דוגמה לתהליך עבודה

1. **העלאת חומר חדש**:
   - לחץ על "+ העלאת חומר"
   - מלא כותרת
   - בחר קורס (למשל: C01)
   - הזן יחידה (למשל: U01)
   - בחר סוג מסמך (למשל: Theory)
   - בחר שפה (he/en)
   - הוסף תוכן ותקציר
   - לחץ "💾 שמירה"

2. **חיפוש חומר**:
   - בחר קורס מהסינון העליון
   - בחר יחידה ספציפית
   - התצוגה תתעדכן אוטומטית

3. **צפייה ועריכה**:
   - לחץ "👁 צפייה" על הפריט
   - ראה את כל הפרטים וה-Metadata
   - לחץ "✏️ עריכה" לשינוי פרטים
   - כל השינויים נשמרים מיד

---

## תמיכה טכנית

לשאלות או בעיות, פנה למפתח או בדוק את:
- `/script.js` - הקוד הראשי של המודול
- `/data/knowledge.json` - קובץ הנתונים
- קונסול הדפדפן (F12) - לבדיקת שגיאות

---

**תאריך עדכון אחרון**: 2025-11-15
**גרסה**: 2.0 (מבנה היררכי)
